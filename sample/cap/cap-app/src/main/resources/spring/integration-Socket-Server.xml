<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:int="http://www.springframework.org/schema/integration"
    xmlns:int-ip="http://www.springframework.org/schema/integration/ip" xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
		http://www.springframework.org/schema/integration http://www.springframework.org/schema/integration/spring-integration.xsd
		http://www.springframework.org/schema/integration/ip http://www.springframework.org/schema/integration/ip/spring-integration-ip.xsd">

    <int:channel id="bytes2string" />
    <int:channel id="toSA" />

    <int-ip:tcp-connection-factory id="crLfServer" type="server" port="5566" single-use="false" using-nio="true" />

    <int-ip:tcp-inbound-gateway id="gatewayCrLf" connection-factory="crLfServer" request-channel="bytes2string" error-channel="errorChannel" />

    <int:transformer id="transformer" ref="hex2StringTransformer" input-channel="bytes2string" output-channel="toSA" />

    <int:service-activator input-channel="toSA" ref="echoService" method="test" />

    <bean id="hex2StringTransformer" class="com.iisigroup.socket_server.app.transformer.Hex2StringTransformer" />

    <bean id="echoService" class="com.iisigroup.socket.server.app.endpoint.EchoService" />

    <int:transformer id="errorHandler" input-channel="errorChannel" expression="payload.failedMessage.payload + ':' + payload.cause.message" />

</beans>
